ball_radious = 0.144;
x=1;y=2;z=3;

% Distances from each node
% Close to real
%n_dist = [1.820, 1.539, 2.488, 2.471, 1.510, 1.593, 1.473, 1.627, 1.914, 2.129, 2.209, 2.138, 1.837                    
%          1.847, 1.560, 1.507, 2.519, 2.522, 2.146, 1.927, 1.643, 1.478, 1.610, 1.919, 2.168, 2.225
%          1.765, 2.475, 1.514, 1.469, 2.396, 2.040, 2.157, 2.071, 1.831, 1.568, 1.427, 1.547, 1.836
%          1.839, 2.510, 2.499, 1.515, 1.532, 1.617, 1.870, 2.139, 2.223, 2.155, 1.877, 1.591, 1.488];

% Estimated
n_dist = [1.886, 1.248, 2.273, 2.333, 1.248, 1.641, 1.502, 1.611, 1.847, 2.061, 2.162, 2.162, 1.847                    
          1.927, 1.343, 1.198, 2.333, 2.396, 2.162, 1.970, 1.672, 1.528, 1.611, 1.886, 2.110, 2.273
          1.809, 2.333, 1.231, 1.182, 2.162, 2.014, 2.162, 2.110, 1.809, 1.583, 1.453, 1.528, 1.773
          1.886, 2.273, 2.396, 1.323, 1.182, 1.555, 1.773, 2.061, 2.110, 2.110, 1.886, 1.611, 1.528];
n_dist = n_dist + ball_radious;

% Each node's position
n = [-1.0000001 -0.9999999 1.3580001
     -0.9999999 1.00000002 1.3580000
      0.9999997 1.00000001 1.3579999
      0.9999999 -0.9999998 1.3580001];

% Test case
te=1;
ALL = [0 0 0];
A = [ 1,-2*n(1,x),-2*n(1,y),-2*n(1,z)
      1,-2*n(2,x),-2*n(2,y),-2*n(2,z)
      1,-2*n(3,x),-2*n(3,y),-2*n(3,z)
      1,-2*n(4,x),-2*n(4,y),-2*n(4,z)];

for t = 1:13
      B = [n_dist(1,t)^2 - n(1,x)^2 - n(1,y)^2 - n(1,z)^2
      n_dist(2,t)^2 - n(2,x)^2 - n(2,y)^2 - n(2,z)^2
      n_dist(3,t)^2 - n(3,x)^2 - n(3,y)^2 - n(3,z)^2
      n_dist(4,t)^2 - n(4,x)^2 - n(4,y)^2 - n(4,z)^2];
      
      T = A\B;
      disp([num2str(t),  ')          ', num2str(T(1)),   '           ', num2str(T(2)), '           ', num2str(T(3)), '           ', num2str(T(4))]);
      disp([num2str(t),')          O:', num2str(T(1)), '           E:', num2str(T(2)^2 + T(3)^2 + T(4)^2)]);
      disp(' ');
      R     = [T(2) T(3) T(4)];
      ALL   = [ALL ; R];
end